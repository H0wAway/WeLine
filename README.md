# 设计文档

# 一、需求分析

## （1）服务端

### 1. 接收客户端连接

### 2. 用户信息验证

### 3. 接收客户端消息并存储，进行消息单发或者群发

### 4. 提取特定用户的消息记录

## （2）客户端

### 1. 登录注册功能

    1. UserName(设计为不可重复，也是唯一用户ID)
    2. Password

### 2. 即时通讯

### 3. 聊天记录读取

# 二、实现思路

## 1. 传输方式：NIO

## 2. 数据格式：

### Message = date + Source + Target + data;

### 创建Message类，专门处理信息

## 3. 服务器：只创建一个线程用以监听客户端信息，根据信息头作不同处理。

1. hashMap1存放客户端信息,hashMap2存放用户聊天记录Message.
2. 将Target当做标志位，接收到USER_LOGIN标识后，调用Login方法，解析data中存储的用户名和密码。
3. 一般标志位，则将Message存入Map2
4. 接收到USER_QUERY标识后，调用QUERY方法，遍历Map2中该用户的聊天记录。

## 4. 客户端：共有两个线程，一个线程用来监听服务器发来的信息，一个线程用于从控制台读取输入。

1. 创建客户端对象，通过TCP协议链接Server
2. 注册登录LOGIN()
3. 信息接收read()接收Message后，输出为 dataSource : data
4. 聊天记录QUERY()



    